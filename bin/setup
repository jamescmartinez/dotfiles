#!/usr/bin/env bash

# Install Homebrew
ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"

# Update Homebrew formulae
brew update

# Install binaries
binaries=(
  zsh
  zsh-completions
  zsh-syntax-highlighting
  git
  hub
  heroku/brew/heroku
  postgres
  openssl
  nvm
  elixir
  pyenv
  fzf
  yarn
  vim
  asdf
)
brew install "${binaries[@]}"

# Set shell to Zsh
chsh -s /usr/local/bin/zsh


# Get latest version of a language
function latest_lang {
  asdf list-all $1 | grep -v - | tail -1
}

# asdf for Ruby
asdf plugin-add ruby
asdf install ruby $(latest_lang ruby)

# asdf for Node.js
asdf plugin-add nodejs
asdf install nodejs $(latest_lang nodejs)

# asdf for Python
asdf plugin-add python
asdf install python $(latest_lang python)

# Install vim-plug
curl -fLo ~/.vim/autoload/plug.vim --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim

# Install Pure Zsh prompt
npm install --global pure-prompt

# Install fzf shell extensions
/usr/local/opt/fzf/install

# Install dotfiles
script_dir=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
$script_dir/dotfiles

# Clean Homebrew
brew cleanup

echo -n "You're all set!"
