#!/usr/bin/env bash

# Install Homebrew
ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"

# Update Homebrew formulae
brew update

# Install binaries
binaries=(
  zsh
  zsh-completions
  zsh-syntax-highlighting
  git
  hub
  heroku/brew/heroku
  postgres
  openssl
  fzf
  yarn
  vim
  asdf
)
brew install "${binaries[@]}"

# Set shell to Zsh
chsh -s /usr/local/bin/zsh

# Install languages using asdf
asdf_install_lang() {
  local language=$1
  asdf plugin-add $language
  local latest_version=$(asdf list-all $language | grep -v - | tail -1)
  asdf install $language $latest_version
  asdf global $language $latest_version
}

asdf_install_lang elixir
asdf_install_lang nodejs
asdf_install_lang python
asdf_install_lang ruby

# Install vim-plug
curl -fLo ~/.vim/autoload/plug.vim --create-dirs https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim

# Install Pure Zsh prompt
npm install --global pure-prompt

# Install fzf shell extensions
/usr/local/opt/fzf/install

# Install dotfiles
script_dir=$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)
$script_dir/dotfiles

# Clean Homebrew
brew cleanup

echo -n "You're all set!"
